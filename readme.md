Описание сервиса

Проектируемый сервис предназначен для обеспечения возможности обмена файлами пользователями приложений для обмена мгновенными сообщениями.
Приложения реализуют протокол XMPP, и работают по клиент-серверной архитектуре. При обмене файлов, отправитель файла загружает его в сетевое хранилище, получателю пересылается ссылка на загруженный файл.
Сервис также имеет возможности для управления загруженными файлами (просмотр списка загруженных файлов, удаление файлов, и т.д.)


Описание API

Авторизация
Bearer Token:
Token требуют передачи параметров авторизации в заголовке HTTP-запроса вида: Authorization Bearer <значение> 
Значение токена получается методом. Используется конкретным пользователем для управлением медиагалереей.


GET api/v1/files/slot/
Получение ответа, можно ли загружать данный файл. Метод принимает гет параметры либо json с метаданными файла(размер, имя, хэш файла).
Если данный пользователь уже имеет такой файл, то генерируется новая ссылка на этот файл. Если такой файл еще не загружен, то приходит ответ 200 и информация о квоте пользователя.

POST api/v1/files/upload/
Загрузка файла на сервер. Метод принимает multipart/form-data с данными файла. Если файл уже есть, то отдаётся ссылка на файл.

GET  api/v1/files/
Получение списка загруженных файлов для конкретного пользователя.

DELETE api/v1/files/
Удаление медиа-файла (симлинка). Если удаляется последний симлинк на файл с таким хэшем, то удаляется и сам физический файл.
Если указать временной промежуток или media_type, то удалятся все объекты, подходящие под эти параметры. Если указать id, то удалится один конкретный файл.

POST api/v1/account/xmpp_code_request/
Запрос одноразового кода по XMPP для получения токена.

POST api/v1/account/xmpp_auth/
Проверка одноразового кода и выдача токена.
	
GET  api/v1/account/tokens/
Получение списка всех токенов пользователя.

DELETE  api/v1/account/tokens/
Удаление токена.

DELETE api/v1/account/
Удаление аккаунта

GET  api/v1/account/quota/
Получение информации о квоте пользователя.

PUT  api/v1/account/quota/
Админский запрос для изменение квоты пользователя.


GET api/v1/account/list/
Админский запрос для получения списка всех пользователей и информации об их квотах.


POST api/v1/avatar/upload/
Загрузка файла на сервер. Метод принимает multipart/form-data с данными файла. Если файл уже есть, то отдаётся ссылка на файл. Загруженный файл обрезается до размеров 1536x1536  с центром кропа посередине(если изначальный размер > 1536, иначе делается кроп по наименьшей стороне) Сохраняется в оригинальном формате.
Названия thumbnail составляются как size_filename.ext. 
Пример: 48_selfie_avatar.webp, 256_selfie_avatar.png.

GET  api/v1/avatar/
Получение списка загруженных аватарок для конкретного пользователя. 

DELETE api/v1/avatar/
Удаление аватарки.

GET  api/v1/files/stats/
Получение статистики по использованию места: категория файла(медиа тип), количество файлов, использованное ими место.
Можно использовать фильтры(медиа тайп, дата больше чем, дата меньше чем).
